# 流浪交大
[![Build Status](http://112.74.62.160:8081/api/badges/bigbag01/SE26017/status.svg)](http://112.74.62.160:8081/bigbag01/SE26017)

### 成员

- 黄佳卉 118037910024
- 余天依 118037910067
- 张贝格 118037910068

## idea 简介

这是一个在校园内部类似QQ宠物的基于web的系统。用户可以选择不同的生物（比如石楠花、噬元兽等）作为自己的宠物。在web界面上，可以看到宠物随着主人的移动在交大地图上移动，随着主人参与校园内某项活动达成成就可以解锁宠物的新功能(比如变身，比如智能对话)。宠物会自己在校园内流浪，当主人再次点开界面，可以召回宠物，有一定概率宠物会带回另一个人的宠物或者讲述一段交大的故事。

"流浪交大"可以帮助大家了解交大的故事，也可以增加认识同学的机会，还可以让同学们多一份参加校园活动的动力。

## 概要需求

#### 初始注册

* 用户注册，在一系列宠物中选择一个作为自己饲养/种植对象
* 宠物向用户简介玩法

#### 登录互动

* 当界面打开时，用户物理位置移动，地图上宠物位置跟随移动
* 用户在某处停止不动超过半小时，宠物有一定几率去校园内流浪
* 用户打开界面时，宠物如果处于流浪状态，可以召回，宠物有一定概率带来小伙伴或者给你讲述一段流浪见闻的交大故事

#### 聊天系统

* 宠物如果带回另一个宠物，用户可以获得与该宠物主人聊天的机会

#### 宠物升级

* 用户可以通过参与校园内活动(比如运动)积累成就
* 用户可以到达某个特定位置等触发特别成就
* 成就可以用于宠物升级，提供更多功能
* 宠物升级功能可以有智能聊天助手，改变宠物形态……



## 架构设计

#### 工作流选择

gitflow

#### 部署
* 租用阿里云服务器，启用docker，使用drone作为CI工具，参考这篇[博客](<https://mritd.me/2018/03/30/set-up-drone-ci/>)进行搭建，个人认为这是参考价值最大的一篇。

  * 配置文件详见`docker-compose.yml`
  * 为了后续的集成需在根目录配置`.drone.yml`

  **CI效果**

  ![](img\bulidsuccess.jpg)

* **踩过的坑**
  * 阿里云服务器购买时选择了预先配置过的服务器，未开放8081端口，需手动添加

  * 在docker上部署完drone之后，项目一直显示**build none**,push后没有任何反应，参考了这篇指导[文章](https://discourse.drone.io/t/nothing-happens-when-i-push-code-no-builds-or-builds-stuck-in-pending/3424)后发现是webhook的配置问题，添加服务器对应的端口号方能正确hook。

    ![](img\webhooks.jpg)
